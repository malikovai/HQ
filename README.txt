ИНСТРУКЦИЯ ПО УСТАНОВКЕ ASE DIGITAL HQ (OFFLINE / SPLIT VERSION)
================================================================

ОПИСАНИЕ:
Этот пакет содержит автономную версию системы ASE Digital HQ.
Архив с дистрибутивом разбит на части (part_aa, part_ab, ...) для удобства передачи.

ТРЕБОВАНИЯ К СЕРВЕРУ:
1. ОС: Linux (Ubuntu 20.04+, Debian 11+, CentOS 8+).
2. ПО: Docker (v20+) и Docker Compose (v2+).
3. Интернет: НЕ требуется (все образы и зависимости включены в пакет).

----------------------------------------------------------------
ЭТАП 1: СБОРКА АРХИВА
----------------------------------------------------------------
1. Скопируйте все файлы частей (part_aa, part_ab, part_ac ... part_ak) в одну папку на сервере.

2. Соберите их в единый архив установщика одной командой:
   cat part_* > digital-hq-installer.tar.gz

3. (Опционально) Убедитесь, что появился файл 'digital-hq-installer.tar.gz' размером около 260 МБ.

----------------------------------------------------------------
ЭТАП 2: РАСПАКОВКА И ЗАГРУЗКА
----------------------------------------------------------------
1. Распакуйте полученный архив:
   tar -xzvf digital-hq-installer.tar.gz

2. Перейдите в папку дистрибутива:
   cd dist

3. Запустите скрипт установки (он загрузит Docker-образы в систему):
   sudo bash install.sh

   *Вы увидите сообщения "Loading layer...", это нормально.*

----------------------------------------------------------------
ЭТАП 3: НАСТРОЙКА
----------------------------------------------------------------
1. Откройте файл конфигурации, созданный скриптом:
   nano .env

2. Отредактируйте параметры безопасности (ОБЯЗАТЕЛЬНО):
   - DB_PASSWORD=... (установите сложный пароль для базы данных)
   - JWT_SECRET=... (установите длинную случайную строку для шифрования токенов)
   - WEB_PORT=80   (порт, на котором откроется сайт, по умолчанию 80)

----------------------------------------------------------------
ЭТАП 4: ЗАПУСК
----------------------------------------------------------------
1. Запустите приложение:
   sudo docker compose up -d

2. Проверьте, что все 3 контейнера (hq-db, hq-api, hq-web) запустились:
   sudo docker compose ps

ДОСТУП К СИСТЕМЕ:
Откройте браузер и введите IP-адрес сервера (например, http://192.168.1.X).
База данных будет инициализирована автоматически при первом старте.
----------------------------------------------------------------
ЭТАП 5: СОЗДАНИЕ АДМИНИСТРАТОРА (ВЫПОЛНИТЬ ОДИН РАЗ)
----------------------------------------------------------------
Так как база данных чистая, нужно создать первого пользователя.

1. Убедитесь, что файл 'init.js' находится в той же папке, что и эта инструкция.

2. Скопируйте скрипт внутрь контейнера с бэкендом:
   sudo docker cp init.js hq-api:/app/init.js

3. Запустите скрипт создания администратора:
   sudo docker exec hq-api node /app/init.js

   Если всё прошло успешно, вы увидите сообщение с логином и паролем:
   Логин:  admin@hq.local
   Пароль: admin123

ДОСТУП К СИСТЕМЕ:
1. Откройте браузер и введите IP-адрес сервера.
2. Войдите, используя данные администратора (admin@hq.local / admin123).
3. ВАЖНО: Сразу после входа смените пароль и создайте структуру организации в панели управления.
----------------------------------------------------------------
КАК ИЗМЕНИТЬ НАЗВАНИЕ И КОНТАКТЫ
----------------------------------------------------------------
В папке 'ui' находятся файлы интерфейса. Вы можете редактировать их
обычным текстовым редактором (nano, notepad++), изменения применятся
сразу после обновления страницы в браузере.

1. Файл входа (ui/login.html):
   - Откройте файл: nano ui/login.html
   - Название вкладки браузера: найдите тег <title>...</title>
   - Заголовок на странице: найдите текст внутри тега <h3> или <h5>
   - Контакты (футер): найдите блок <div class="footer"> или просто добавьте свой текст внизу.

2. Главная страница (ui/index.html):
   - Откройте файл: nano ui/index.html
   - Название системы (слева вверху):
     Найдите строку: <div class="sidebar-brand">...ASE.HQ...</div>
     Замените на свое название, например: <div class="sidebar-brand">МОЯ КОМПАНИЯ</div>
   
   - Контакты техподдержки (можно добавить в меню):
     Найдите блок <div class="sidebar">...</div>
     Вставьте перед строкой "Выход" новый пункт:
     <div class="px-4 text-secondary small mt-auto mb-3">
        Техподдержка:<br> тел. 123-45-67
     </div>

3. Применение изменений:
   Если контейнер уже запущен, достаточно просто обновить страницу в браузере (Ctrl+F5).
   Перезагружать сервер не нужно.